#
# Makefile : XKY configuration
# Generated by XKY Configurator Tool v4.0a
#


# XKY install directory
export XKY_INSTALL=/home/peec/git/internal/XKY_dev/dev_jetson_bsp_new/install

include $(XKY_INSTALL)/Makefile.inc

# XKY OS installation directories
export XKY_PMK=$(XKY_INSTALL)/pmk
export XKY_POS=$(XKY_INSTALL)/pos
export XKY_LIBS=$(XKY_INSTALL)/libs



XKY_APP=executable/XKYAPP.exe
XKY_APP_BIN=executable/XKYAPP.bin

# all
.PHONY : all
all: $(XKY_APP)

# build XKY application
$(XKY_APP): p0
	$(PARTITION_ASSEMBLER) -id 0 -s 0x00040000 -o config/xef_p00.bin p0/p0.exe
	$(MKDIR) $(dir $(XKY_APP))
	$(IMAGE_ASSEMBLER) \
		-xmf config/xmf.bin \
		-xpf config/xpf_p00.bin \
		-xef config/xef_p00.bin \
		-o $(XKY_APP_BIN)
	$(LD) -b binary $(XKY_APP_BIN) -Ttext=0x80000000 -e 0x80000000 -o $(XKY_APP)

# clean
.PHONY : clean
clean:
	$(MAKE) -C p0 clean
	$(RM) $(XKY_APP)
	$(RM) $(XKY_APP_BIN)

# distclean
.PHONY : distclean
distclean: clean
	$(MAKE) -C p0 distclean
	$(RM) p0/Makefile
	$(RM) config/xmf.bin
	$(RM) config/xpf_p00.bin
	$(RM) config/xef_p00.bin
	$(RM) config
	$(RM) executable
	$(RM) .config
	$(RM) Makefile

.PHONY : p0
p0: 
	echo ===== Building $@ ===== >&2
	$(MAKE) -C p0 all XKY_INSTALL=$(XKY_INSTALL)

